"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[449],{57026:(e,t,n)=>{n.d(t,{Z:()=>u});var r,a,o=n(35776);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}const u=function(e){return o.createElement("svg",l({width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"icon"},e),r||(r=o.createElement("defs",null,o.createElement("clipPath",{id:"outlined_svg__a"},o.createElement("path",{fill:"currentcolor",d:"M11.541.514a4 4 0 011.4 1.317l.126.209 5.58 9.92a4 4 0 01-3.23 5.953l-.256.008H4a4 4 0 01-3.605-5.733l.119-.228 5.58-9.92A4 4 0 0111.541.514zM7.92 2.887l-.082.133-5.58 9.92a2 2 0 001.594 2.976L4 15.92h11.16a2 2 0 001.815-2.841l-.071-.14-5.58-9.92a2 2 0 00-3.405-.133zM9.58 11.92a1 1 0 110 2 1 1 0 010-2zm0-7a1 1 0 011 1v4a1 1 0 11-2 0v-4a1 1 0 011-1z"})))),a||(a=o.createElement("g",{clipPath:"url(#outlined_svg__a)",fill:"currentcolor",transform:"translate(2.42 3.079)"},o.createElement("path",{d:"M0 0h19.161v17.921H0V0z"}))))}},68781:(e,t,n)=>{n.d(t,{Z:()=>u});var r,a,o=n(35776);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}const u=function(e){return o.createElement("svg",l({width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"icon"},e),r||(r=o.createElement("defs",null,o.createElement("clipPath",{id:"filled_svg__a"},o.createElement("path",{d:"M9.69 0a6.812 6.812 0 016.807 6.576l.004.235v3.527a3.284 3.284 0 01-5.768 2.148l-.064-.08-.103.103a4.117 4.117 0 01-2.595 1.106l-.227.007a4.135 4.135 0 01-4.135-4.136v-.972A4.135 4.135 0 019.95 5.016l.034.023.005-.016a.974.974 0 01.802-.638l.114-.007c.488 0 .899.362.966.858l.007.115v4.987a1.338 1.338 0 002.67.126l.006-.126V6.81a4.864 4.864 0 00-4.66-4.86l-.205-.005H6.81a4.864 4.864 0 00-4.86 4.66l-.004.205v4.378a4.864 4.864 0 004.66 4.86l.205.005H9.69a.973.973 0 01.115 1.939L9.69 18H6.81a6.812 6.812 0 01-6.806-6.576L0 11.189V6.811A6.812 6.812 0 016.576.004L6.811 0H9.69zM7.744 6.324c-1.21 0-2.19.98-2.19 2.19v.972a2.19 2.19 0 104.379 0v-.972c0-1.21-.98-2.19-2.19-2.19z"})))),a||(a=o.createElement("g",{clipPath:"url(#filled_svg__a)",transform:"translate(3.5 3)"},o.createElement("path",{fill:"currentcolor",d:"M0 0h16.5v18H0V0z"}))))}},80736:(e,t,n)=>{n.d(t,{Z:()=>l});var r,a=n(35776);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}const l=function(e){return a.createElement("svg",o({width:"1em",height:"1em",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",className:"icon"},e),r||(r=a.createElement("path",{d:"M20.25 13.375a3.125 3.125 0 01-5.723 1.738A4 4 0 017.5 12.5v-1a4 4 0 016.501-3.122L14 8.25a.75.75 0 011.493-.102l.007.102v5.125a1.625 1.625 0 003.244.14l.006-.14V9.75a5.25 5.25 0 00-5.034-5.246L13.5 4.5h-3a5.25 5.25 0 00-5.246 5.034l-.004.216v4.5a5.25 5.25 0 005.034 5.246l.216.004h3a.75.75 0 01.102 1.493L13.5 21h-3a6.75 6.75 0 01-6.746-6.513l-.004-.237v-4.5a6.75 6.75 0 016.513-6.746L10.5 3h3a6.75 6.75 0 016.746 6.513l.004.237v3.625zM11.5 9A2.5 2.5 0 009 11.5v1a2.5 2.5 0 105 0v-1A2.5 2.5 0 0011.5 9z",fill:"currentcolor",fillRule:"evenodd"})))}},45409:(e,t,n)=>{n.d(t,{x:()=>u});var r=n(94184),a=n.n(r),o=n(35776),l=n(77405);function u(e){let t=e.users,n=e.selected,r=e.onClick;return null!=t&&t.length?o.default.createElement("ul",{className:"flex overflow-hidden flex-col w-70 rounded-16 border border-theme-divider-secondary text-theme-label-primary",role:"listbox"},t.map(((e,t)=>o.default.createElement(l.z,{key:e.username,user:e,className:{container:a()("p-3 cursor-pointer",t===n&&"bg-theme-active")},imageSize:"large",tag:"li",onClick:()=>r(e.username),"aria-selected":t===n,role:"option",disableTooltip:!0})))):null}},80506:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(35776),a=n(86548),o=n(57026);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}const u=e=>r.default.createElement(a.Z,l({},e,{IconPrimary:o.Z,IconSecondary:o.Z}))},19366:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(35776),a=n(86548),o=n(80736),l=n(68781);function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}const c=e=>r.default.createElement(a.Z,u({},e,{IconPrimary:o.Z,IconSecondary:l.Z}))},1796:(e,t,n)=>{n.d(t,{Z:()=>b});var r=n(86484),a=n.n(r),o=n(35776),l=n(94184),u=n.n(l),c=n(62835),i=n(30435),s=n(69065),f=n(38050),d=n(82546),m=n(32210),p=n(25763),v=n(18608),h=n(43197);function y(e,t,n,r,a,o,l){try{var u=e[o](l),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,a)}const b=function(e){let t=e.parentComment,n=e.input,r=e.children,l=e.errorMessage,b=e.onInput,g=e.sendComment,w=e.parentSelector,x=e.useUserMentionOptions;const E=t.authorImage,O=t.authorName,S=t.publishDate,k=t.contentHtml,C=t.editContent,P=(0,o.useContext)(c.ZP).user,I=x.onMentionClick,N=x.onMentionKeypress,j=x.offset,M=x.mentions,z=x.mentionQuery,A=x.selected,T=x.commentRef,Z=x.onInputClick;(0,o.useEffect)((()=>{const e=T.current;if(!e)return;e.focus();const t=n||C;t&&(e.value=t,e.setSelectionRange(e.value.length,e.value.length)),e.setAttribute("data-min-height",e.offsetHeight.toString())}),[]);const _=function(){var e,t=(e=a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,h.qc)(t)&&N(t.key,t);case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function l(e){y(o,r,a,l,u,"next",e)}function u(e){y(o,r,a,l,u,"throw",e)}l(void 0)}))});return function(e){return t.apply(this,arguments)}}();return(0,o.useEffect)((()=>{var e;null!=M&&M.length||null==T||null===(e=T.current)||void 0===e||e.focus()}),[M]),o.default.createElement(o.default.Fragment,null,o.default.createElement("article",{className:"flex flex-col items-stretch rounded-8 break-words-overflow typo-callout"},o.default.createElement("header",{className:"flex items-center mb-2"},o.default.createElement(f.YY,{size:"large",rounded:"full",user:{image:E,username:O},nativeLazyLoading:!0}),o.default.createElement("div",{className:"flex flex-col ml-2"},o.default.createElement("div",{className:"truncate typo-callout"},O),o.default.createElement("time",{dateTime:S.toString(),className:"text-theme-label-tertiary typo-callout"},(0,i.Pe)(S)))),o.default.createElement(d.Z,{content:k})),o.default.createElement("div",{className:"flex items-center px-2 h-11"},o.default.createElement("div",{className:"ml-3 w-px h-full bg-theme-divider-tertiary"}),o.default.createElement("div",{className:"ml-6 text-theme-label-secondary typo-caption1"},"Reply to"," ",o.default.createElement("strong",{className:"font-bold text-theme-label-primary"},O))),o.default.createElement("div",{className:"flex relative flex-1 pl-2"},o.default.createElement(f.YY,{user:P,size:"small",nativeLazyLoading:!0}),o.default.createElement("textarea",{className:u()("ml-3 flex-1 text-theme-label-primary bg-transparent border-none caret-theme-label-link break-words typo-subhead resize-none",s.Z.textarea),defaultValue:n,ref:T,placeholder:"Share your thoughts",onInput:e=>{const t=e.target;(0,p.n)(t),b((0,v.X)(t.value)),N(e.data,e)},onKeyDown:e=>{if((e.ctrlKey||e.metaKey)&&e.key===h.SO.Enter&&null!=n&&n.length)return g(e);return(e.key===h.SO.Enter||h.IJ.includes(e.key))&&null!=M&&M.length?e.preventDefault():e.stopPropagation()},onKeyUp:_,onClick:Z,onPaste:e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain");document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,t):document.execCommand("paste",!1,t)},tabIndex:0,"aria-label":"New comment box","aria-multiline":!0})),o.default.createElement(m.l,{elementRef:T,offset:j,mentions:M,selected:A,query:z,appendTo:w,onMentionClick:I}),o.default.createElement("div",{className:"my-2 mx-3 text-theme-status-error typo-caption1",style:{minHeight:"1rem"}},l&&o.default.createElement("span",{role:"alert"},l)),r)}},15195:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var r=n(86484),a=n.n(r),o=n(35776),l=n(88767),u=n(45909),c=n(50562),i=n(82546),s=n(1796),f=n(26990),d=n(77803),m=n(58953),p=n(19366),v=n(23833),h=n(25763),y=n(25782),b=n(52250),g=n(69282),w=n(39572),x=n(38632),E=n(33793),O=n(47393),S=n(45544),k=n(38577);const C=["onRequestClose","onComment","onInputChange","parentSelector","parentComment","post"];function P(){return P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},P.apply(this,arguments)}function I(e,t,n,r,a,o,l){try{var u=e[o](l),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,a)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function l(e){I(o,r,a,l,u,"next",e)}function u(e){I(o,r,a,l,u,"throw",e)}l(void 0)}))}}function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{l||null==n.return||n.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Z;!function(e){e.Write="Write",e.Preview="Preview"}(Z||(Z={}));const _={title:"Discard comment",description:"Are you sure you want to close and discard your comment?",okButton:{className:"btn-primary-ketchup",title:"Discard"},cancelButton:{title:"Stay"}},q=e=>{let t=e.input,n=e.sourceId,r=e.parentSelector;const a=(0,o.useContext)(w.LO).activeView,s=(0,d.Y)().requestMethod,f=["comment_preview",t],p=(0,l.useQuery)(f,(()=>s(c.B3,u.H4,{content:t,sourceId:n},{requestKey:JSON.stringify(f)})),{enabled:(null==t?void 0:t.length)>0&&a===Z.Preview}).data;return o.default.createElement(m.u_.Body,{view:Z.Preview},o.default.createElement(i.Z,{content:null==p?void 0:p.preview,appendTooltipTo:r}))};function D(e){let t=e.onRequestClose,n=e.onComment,r=e.onInputChange,i=e.parentSelector,w=e.parentComment,I=e.post,A=T(e,C);const D=w.handle,L=w.commentId,B=w.editId,H=w.editContent,K=w.replyTo,R=w.authorId,Y=z((0,o.useState)(H||K),2),J=Y[0],$=Y[1],W=z((0,o.useState)(!1),2),U=W[0],F=W[1],Q=z((0,o.useState)(null),2),V=Q[0],X=Q[1],G=(0,g.G)().showPrompt,ee=(0,d.Y)().requestMethod,te=(0,l.useQuery)((0,x.e0)(x.dt.PostComments,null,{authorId:R,sourceId:I.source.id}),(()=>(0,E.e9)(I.source.id,R)),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({enabled:!!R&&I.source.type===O.PO.Squad,retry:!1},k.t3)),ne=te.data,re=te.isFetched,ae=function(){var e=N(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=!H&&null!=J&&J.length||H&&H!==J,!e.t0){e.next=5;break}return e.next=4,G(_);case 4:e.t0=!e.sent;case 5:if(!e.t0){e.next=7;break}return e.abrupt("return");case 7:t(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=["post_comments_mutations",I.id],le=(0,l.useMutation)((e=>ee(c.B3,L?u.y5:u.hK,e,{requestKey:JSON.stringify(oe)})),{onSuccess:e=>e&&n(e.comment,!0)}).mutateAsync,ue=(0,l.useMutation)((e=>ee(c.B3,u.hp,e,{requestKey:JSON.stringify(oe)})),{onSuccess:e=>e&&n(e.comment,!1)}).mutateAsync,ce=function(){var e=N(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!U&&null!=J&&J.trim().length){e.next=2;break}return e.abrupt("return");case 2:if(X(null),F(!0),e.prev=4,!B){e.next=10;break}return e.next=8,ue({id:B,content:J});case 8:e.next=12;break;case 10:return e.next=12,le({id:L||I.id,content:J});case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(4),X("Something went wrong, try again"),F(!1);case 18:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(){return e.apply(this,arguments)}}(),ie=(0,h.v)({postId:I.id,sourceId:I.source.id,onInput:$});(0,o.useEffect)((()=>{null==r||r(J)}),[J]);const se=!(null!=J&&J.trim().length),fe=o.default.createElement(f.z,{disabled:se,loading:U,onClick:ce,className:"ml-auto btn-primary-avocado"},B?"Update":"Post");return o.default.createElement(m.u_,P({contentRef:e=>{e&&(e.scrollTop=e.scrollHeight-e.clientHeight)},onRequestClose:ae,kind:m.u_.Kind.FlexibleTop,size:m.u_.Size.Medium,tabs:Object.values(Z),parentSelector:i},A),o.default.createElement(m.u_.Header.Tabs,{disabledTab:e=>e===Z.Preview&&se}),o.default.createElement(m.u_.Body,{view:Z.Write},o.default.createElement(s.Z,P({},A,{parentComment:w,useUserMentionOptions:ie,onInput:$,input:J,errorMessage:V,sendComment:ce}),!re||ne&&ne.role!==O.Pt.Blocked?null:o.default.createElement(S.ZP,{type:S.NK.Info,title:`${D} is no longer part of the squad and will not be able to see or reply to your comment.`}))),o.default.createElement(q,{input:J,sourceId:I.source.id,parentSelector:i}),o.default.createElement(m.u_.Footer,{justify:b.WD.Between,view:Z.Write},o.default.createElement(f.z,{className:"btn-tertiary",buttonSize:f.q.Small,icon:o.default.createElement(p.Z,null),onClick:ie.onInitializeMention}),o.default.createElement("div",{className:"-ml-2 w-px h-6 border border-opacity-24 border-theme-divider-tertiary"}),o.default.createElement(v.D,{tag:"a",href:y.dT,className:"typo-caption1",defaultTypo:!1,target:"_blank"},"Markdown supported"),fe),o.default.createElement(m.u_.Footer,{view:Z.Preview},fe))}},77405:(e,t,n)=>{n.d(t,{z:()=>v});var r=n(94184),a=n.n(r),o=n(35776),l=n(38050),u=n(52250),c=n(57877);const i=["imageSize","tag","user","className","disableTooltip","scrollingContainer","appendTooltipTo","children"];function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}function f(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}const d=(0,u.be)(),m="py-3 px-6 hover:bg-theme-hover",p="flex-1";function v(e){var t,n,r;let u=e.imageSize,v=void 0===u?"xlarge":u,h=e.tag,y=e.user,b=e.className,g=void 0===b?{}:b,w=e.disableTooltip,x=e.scrollingContainer,E=e.appendTooltipTo,O=e.children,S=f(e,i);const k=h||"a",C=y.name,P=y.username,I=y.bio,N={appendTo:E||(null===(t=document)||void 0===t?void 0:t.body)||"parent",visible:!w&&void 0};return o.default.createElement(k,s({},S,{className:a()("flex flex-row",null!==(n=g.container)&&void 0!==n?n:m)}),o.default.createElement(c.R,{user:y,tooltip:N,scrollingContainer:x},o.default.createElement(l.YY,{user:y,size:v,nativeLazyLoading:!0})),o.default.createElement(c.R,{user:y,tooltip:N,scrollingContainer:x},o.default.createElement("div",{className:a()("flex overflow-hidden flex-col ml-4 typo-callout",null!==(r=g.textWrapper)&&void 0!==r?r:p)},o.default.createElement(d,{className:"font-bold"},C),o.default.createElement(d,{className:"text-theme-label-secondary"},"@",P),I&&o.default.createElement("span",{className:"mt-1 text-theme-label-tertiary"},I))),O)}},32210:(e,t,n)=>{n.d(t,{l:()=>i});var r=n(35776),a=n(58084),o=n(45409),l=n(25782);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{l||null==n.return||n.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){var t;let n=e.query,c=e.mentions,i=void 0===c?[]:c,s=e.selected,f=void 0===s?-1:s,d=e.offset,m=void 0===d?[0,0]:d,p=e.onMentionClick,v=e.appendTo,h=e.elementRef;if(l.jp)return null;const y=u(m,2),b=y[0],g=y[1],w=64*i.length;return r.default.createElement(a.BaseTooltip,{appendTo:v||(null===(t=document)||void 0===t?void 0:t.body)||"parent",content:r.default.createElement(o.x,{users:void 0!==n&&i,selected:f,onClick:p}),offset:[b,-1*(g+w+26)],interactive:!0,container:{className:"shadow",paddingClassName:"p-0",roundedClassName:"rounded-16",bgClassName:"bg-theme-bg-tertiary"},reference:h,showArrow:!1,placement:"top-start",visible:void 0!==n})}},45544:(e,t,n)=>{n.d(t,{NK:()=>f,ZP:()=>h,oM:()=>v});var r=n(35776),a=n(94184),o=n.n(a),l=n(86456),u=n(80506),c=n(63031),i=n(32256),s=n(86548);let f;!function(e){e.Info="info",e.Error="error",e.Success="success"}(f||(f={}));const d={info:"text-theme-color-bun",error:"text-theme-status-error",success:"text-theme-status-success"},m={info:"border-l-theme-color-bun",error:"border-l-theme-status-error",success:"border-l-theme-status-success"},p={info:l.Z,error:u.Z,success:c.Z},v=(0,i.Z)("p","typo-callout mt-3");const h=function(e){let t=e.className,n=e.title,a=e.children,l=e.type,u=void 0===l?f.Info:l;const c=p[u];return r.default.createElement("div",{className:o()("flex flex-col p-3 border border-theme-active border-l-4",m[u],a?"rounded-16":"rounded-12",t)},r.default.createElement("span",{className:"flex flex-row items-center"},r.default.createElement(c,{size:s.J.Small,className:o()("mr-2",d[u])}),r.default.createElement("span",{className:o()("typo-callout flex flex-1",a&&"font-bold",a&&d[u])},n)),a)}},25763:(e,t,n)=>{n.d(t,{n:()=>g,v:()=>w});var r=n(86484),a=n.n(r),o=n(88767),l=n(35776),u=n(45909),c=n(50562),i=n(62835),s=n(17291),f=n(18608),d=n(43197),m=n(38577),p=n(77803);function v(e,t,n,r,a,o,l){try{var u=e[o](l),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,a)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function l(e){v(o,r,a,l,u,"next",e)}function u(e){v(o,r,a,l,u,"throw",e)}l(void 0)}))}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{l||null==n.return||n.return()}finally{if(u)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const g=e=>{const t=e.getAttribute("data-min-height"),n=parseInt(t,10);e.style.height="auto",e.style.height=`${Math.max(e.scrollHeight,n)}px`};function w(e){let t=e.postId,n=e.sourceId,r=e.onInput;const v=(0,l.useRef)(null),b=(0,l.useContext)(i.ZP).user,w=(0,o.useQueryClient)(),x=y((0,l.useState)(0),2),E=x[0],O=x[1],S=y((0,l.useState)([0,0]),2),k=S[0],C=S[1],P=y((0,l.useState)([0,0]),2),I=P[0],N=P[1],j=y((0,l.useState)(),2),M=j[0],z=j[1],A=["user-mention",t,n,M],T=(0,p.Y)().requestMethod,Z=(0,o.useQuery)(A,(()=>T(c.B3,u.IP,{postId:t,query:M,sourceId:n},{requestKey:JSON.stringify(A)})),{enabled:!!b&&void 0!==M,refetchOnWindowFocus:!1,refetchOnMount:!1}),_=Z.data,q=void 0===_?{recommendedMentions:[]}:_,D=Z.refetch,L=(q||{}).recommendedMentions,B=y((0,s.Z)(D,100),1)[0],H=function(){var e=h(a().mark((function e(t){var n,r,o,l,u,c,i,s,f,p,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,m.Y3)();case 2:if(n=v.current,r=(0,d.FN)(n),o=y(r,2),l=o[0],u=o[1],c=(0,d.qx)(n,[l,u]),i=y(c,3),s=i[0],f=i[1],p=i[2],s){e.next=8;break}return null==t||t(),e.abrupt("return");case 8:if(h=(0,d.gW)(n),f!==M){e.next=11;break}return e.abrupt("return");case 11:z(f),N([p,u]),C(h);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=e=>{if(null==L||!L.length)return;const t=v.current,n=`@${M}`,a=`@${e}`;(0,d.Oc)(t,I,n,a);const o=(0,d.kC)(t.value,I);t.focus(),t.selectionEnd=o+a.length,z(void 0),w.setQueryData(A,[]),r(t.value),g(t),v.current.focus()},R=e=>{const t=(0,d.oz)(e,I),n=""===M&&""===t||M===t||0===e.value.length?void 0:t;z(n),B()},Y=()=>{H((()=>z(void 0)))},J=function(){var e=h(a().mark((function e(t,n){var r,o,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.JW.includes(t)){e.next=2;break}return e.abrupt("return",Y());case 2:if(r=t===d.SO.Backspace||n.inputType&&d.$q.includes(n.inputType),o=t===d.SO.Enter||n.inputType===d.z7.InsertLineBreak,void 0!==M){e.next=8;break}if((0,f.bJ)(null!=t?t:"")||"@"===t||r){e.next=7;break}return e.abrupt("return",null);case 7:return e.abrupt("return",H());case 8:if(!d.IJ.includes(t)){e.next=11;break}return(a=t)===d.CD.Up&&E>0?O(E-1):a===d.CD.Down&&E<L.length-1&&O(E+1),e.abrupt("return",n.preventDefault());case 11:if(" "!==t){e.next=13;break}return e.abrupt("return",z(void 0));case 13:if(!o){e.next=16;break}return n.preventDefault(),e.abrupt("return",K(L[E].username));case 16:return e.next=18,(0,m.Y3)();case 18:if(!r){e.next=20;break}return e.abrupt("return",R(v.current));case 20:return l=(0,f.xJ)(t)?void 0:(0,d.oz)(v.current,I),z(l),l&&B(),e.abrupt("return",null);case 24:case"end":return e.stop()}var a}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=()=>{if(void 0!==M||!v.current)return;const e=v.current,t=e.selectionStart,n=e.value.substring(0,t),r=e.value.substring(t);e.value=`${n} @ ${r}`,e.focus(),e.selectionEnd=t+2,e.dispatchEvent(new InputEvent("input",{data:"@"}))};return(0,l.useEffect)((()=>{var e;const t=e=>{if(e.stopPropagation(),void 0===M)return;const t=e.target,n="textarea"===t.tagName.toLocaleLowerCase(),r=(0,d.tD)(t,"tippy-content");n||r||z(void 0)},n=null===(e=v.current)||void 0===e?void 0:e.getRootNode();return null==n||n.addEventListener("mousedown",t),()=>{null==n||n.removeEventListener("mousedown",t)}}),[M]),(0,l.useEffect)((()=>{O(0)}),[M]),(0,l.useMemo)((()=>({commentRef:v,offset:k,selected:E,mentions:L,mentionQuery:M,onInputClick:Y,onMentionClick:K,onMentionKeypress:J,onInitializeMention:$})),[v,k,E,L,M])}},69065:(e,t,n)=>{n.d(t,{Z:()=>r});const r={textarea:"_1OXiSCwqooYx1fMwTCenKA"}}}]);