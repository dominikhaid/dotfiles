(()=>{"use strict";const e={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let t;const o=new Uint8Array(16);function n(){if(!t&&(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!t))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(o)}const r=[];for(let e=0;e<256;++e)r.push((e+256).toString(16).slice(1));const c=function(t,o,c){if(e.randomUUID&&!o&&!t)return e.randomUUID();const i=(t=t||{}).random||(t.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,o){c=c||0;for(let e=0;e<16;++e)o[c+e]=i[e];return o}return function(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}(i)};function i(e){return new Promise(((t,o)=>{chrome.storage.sync.get([e],(n=>chrome.runtime.lastError?o(chrome.runtime.lastError):t(n[e])))}))}function s(e,t){return new Promise(((o,n)=>{chrome.storage.sync.set({[e]:t},(()=>chrome.runtime.lastError?n(chrome.runtime.lastError):o()))}))}document.getElementById("login")?.addEventListener("click",(async function(){const e=c();await chrome.runtime.sendMessage({type:"state",payload:{state:e}}),await chrome.tabs.create({url:`https://www.codeium.com/profile?redirect_uri=chrome-extension://${chrome.runtime.id}&state=${e}`})})),document.getElementById("go-to-options")?.addEventListener("click",(()=>{chrome.runtime.openOptionsPage()})),i("user").then((e=>{const t=document.getElementById("username");null!==t&&void 0!==e&&(t.textContent=`Welcome, ${e.name}`)})).catch((e=>{console.error(e)})),document.getElementById("logout")?.addEventListener("click",(async()=>{await s("user",{}),await async function(){await Promise.all([chrome.action.setPopup({popup:"popup.html"}),chrome.action.setBadgeText({text:"Login"}),chrome.action.setIcon({path:{16:"/icons/16/codeium_square_inactive.png",32:"/icons/32/codeium_square_inactive.png",48:"/icons/48/codeium_square_inactive.png",128:"/icons/128/codeium_square_inactive.png"}}),chrome.action.setTitle({title:"Codeium"}),s("lastError",{})])}(),window.close()})),i("lastError").then((e=>{const t=document.getElementById("error");if(null==t)return;const o=e?.message;void 0===o?t.remove():t.textContent=o}))})();